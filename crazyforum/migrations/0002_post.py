# Generated by Django 4.0.5 on 2022-08-17 11:08

from datetime import datetime
from django.db import migrations, models
import django.db.models.deletion

posts = [
    [
        "SQL Injections are dangerous", 
        "SQL Injections are really dangerous as an otherwise harmless query can be injected to execute anything supplied by the attacker on the victim's database!",
        datetime(2022, 1, 1),
        "splinter",
    ],
    [
        "The wanders of SCA tools", 
        "SCA tools are really important to keep you Open Source components safe from vulnerabilities. Check out the best one ever at: <a>https://debricked.com</a>",
        datetime(2021, 10, 5),
        "splinter",
    ],
    [
        "First post of the forum",
        "I'm so excited to release this forum to the public!",
        datetime(2020, 12, 12),
        "admin",
    ]
]

def add_posts(apps, schema_editor):
     User = apps.get_model('crazyforum', 'User')
     Post = apps.get_model('crazyforum', 'Post')
     for p in posts:
         Post.objects.create(
             title=p[0],
             content=p[1],
             publish_date=p[2],
             author=User.objects.get(username=p[3])
         )
         
class Migration(migrations.Migration):

    dependencies = [
        ('crazyforum', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Post',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=255)),
                ('content', models.CharField(max_length=500)),
                ('publish_date', models.DateTimeField(blank=True, null=True)),
                ('author', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='crazyforum.user')),
            ],
        ),
        migrations.RunPython(add_posts),
    ]